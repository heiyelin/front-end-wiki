<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>变量与类型 | Front-End-Wiki</title>
    <meta name="description" content="前端知识库">
    
    <meta property="article:modified_time" content="2020-04-04T10:37:29.000Z"><meta property="og:site_name" content="Front-End-Wiki"><meta property="og:title" content="变量与类型"><meta property="og:type" content="website"><meta property="og:url" content="/guide/js/variables-and-types.html"><meta name="twitter:title" content="变量与类型"><meta name="twitter:url" content="/guide/js/variables-and-types.html"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:label1" content="Written by">
    <link rel="preload" href="/assets/css/0.styles.9e24d197.css" as="style"><link rel="preload" href="/assets/js/app.0d36fc07.js" as="script"><link rel="preload" href="/assets/js/2.b6aa8f81.js" as="script"><link rel="preload" href="/assets/js/46.dcbd0d34.js" as="script"><link rel="prefetch" href="/assets/js/10.8bfd4ea1.js"><link rel="prefetch" href="/assets/js/11.fe52658a.js"><link rel="prefetch" href="/assets/js/12.e0e30b8d.js"><link rel="prefetch" href="/assets/js/13.1387d8d2.js"><link rel="prefetch" href="/assets/js/14.8288dbb9.js"><link rel="prefetch" href="/assets/js/15.5d7d6b17.js"><link rel="prefetch" href="/assets/js/16.eecd39ae.js"><link rel="prefetch" href="/assets/js/17.a2d9791b.js"><link rel="prefetch" href="/assets/js/18.3f3747e5.js"><link rel="prefetch" href="/assets/js/19.1cfd61e5.js"><link rel="prefetch" href="/assets/js/20.20c1d3b4.js"><link rel="prefetch" href="/assets/js/21.3b46cf8b.js"><link rel="prefetch" href="/assets/js/22.49b56ccd.js"><link rel="prefetch" href="/assets/js/23.04f55964.js"><link rel="prefetch" href="/assets/js/24.d4de5079.js"><link rel="prefetch" href="/assets/js/25.aba0c982.js"><link rel="prefetch" href="/assets/js/26.731d50fe.js"><link rel="prefetch" href="/assets/js/27.292b230a.js"><link rel="prefetch" href="/assets/js/28.ce5173b2.js"><link rel="prefetch" href="/assets/js/29.863219a8.js"><link rel="prefetch" href="/assets/js/3.6a70c1fb.js"><link rel="prefetch" href="/assets/js/30.398b963b.js"><link rel="prefetch" href="/assets/js/31.8c7b3aa2.js"><link rel="prefetch" href="/assets/js/32.b3465a7f.js"><link rel="prefetch" href="/assets/js/33.51b95476.js"><link rel="prefetch" href="/assets/js/34.040e3223.js"><link rel="prefetch" href="/assets/js/35.a62cada5.js"><link rel="prefetch" href="/assets/js/36.4f915af0.js"><link rel="prefetch" href="/assets/js/37.ec23df85.js"><link rel="prefetch" href="/assets/js/38.7605bc0e.js"><link rel="prefetch" href="/assets/js/39.b50c2b8b.js"><link rel="prefetch" href="/assets/js/4.f998eb39.js"><link rel="prefetch" href="/assets/js/40.2e9d8fee.js"><link rel="prefetch" href="/assets/js/41.fddf0c31.js"><link rel="prefetch" href="/assets/js/42.ddf5dc0a.js"><link rel="prefetch" href="/assets/js/43.2163f6ed.js"><link rel="prefetch" href="/assets/js/44.97cd1965.js"><link rel="prefetch" href="/assets/js/45.50edd4c2.js"><link rel="prefetch" href="/assets/js/47.ab312a1d.js"><link rel="prefetch" href="/assets/js/48.e29f594f.js"><link rel="prefetch" href="/assets/js/5.bd41f6e8.js"><link rel="prefetch" href="/assets/js/6.cfeabc90.js"><link rel="prefetch" href="/assets/js/7.df74b918.js"><link rel="prefetch" href="/assets/js/8.9b9d0339.js"><link rel="prefetch" href="/assets/js/9.d13b94b4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9e24d197.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Front-End-Wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">基础</a></div><div class="nav-item"><a href="/advance/" class="nav-link">进阶</a></div><div class="nav-item"><a href="/dev/" class="nav-link">全栈</a></div><div class="nav-item"><a href="/refer/" class="nav-link">扩展</a></div> <a href="https://github.com/heiyelin/front-end-wiki" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">基础</a></div><div class="nav-item"><a href="/advance/" class="nav-link">进阶</a></div><div class="nav-item"><a href="/dev/" class="nav-link">全栈</a></div><div class="nav-item"><a href="/refer/" class="nav-link">扩展</a></div> <a href="https://github.com/heiyelin/front-end-wiki" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>HTML</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/html/introduce.html" class="sidebar-link">HTML5</a></li><li><a href="/guide/html/web-storage.html" class="sidebar-link">浏览器本地存储</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Javascript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/js/variables-and-types.html" class="active sidebar-link">变量与类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/js/variables-and-types.html#一、js-变量在内存中的存储形式" class="sidebar-link">一、JS 变量在内存中的存储形式</a></li><li class="sidebar-sub-header"><a href="/guide/js/variables-and-types.html#二、js-的数据类型" class="sidebar-link">二、JS 的数据类型</a></li><li class="sidebar-sub-header"><a href="/guide/js/variables-and-types.html#三、基本类型的拆箱与装箱操作" class="sidebar-link">三、基本类型的拆箱与装箱操作</a></li><li class="sidebar-sub-header"><a href="/guide/js/variables-and-types.html#四、null-与-undefined-的区别" class="sidebar-link">四、null 与 undefined 的区别</a></li><li class="sidebar-sub-header"><a href="/guide/js/variables-and-types.html#五、js-中判断数据类型的几种方式" class="sidebar-link">五、JS 中判断数据类型的几种方式</a></li><li class="sidebar-sub-header"><a href="/guide/js/variables-and-types.html#六、隐式转换" class="sidebar-link">六、隐式转换</a></li><li class="sidebar-sub-header"><a href="/guide/js/variables-and-types.html#七、精度缺失及解决办法" class="sidebar-link">七、精度缺失及解决办法</a></li><li class="sidebar-sub-header"><a href="/guide/js/variables-and-types.html#八、instanceof-实现原理" class="sidebar-link">八、instanceOf 实现原理</a></li></ul></li><li><a href="/guide/js/prototype.html" class="sidebar-link">原型与继承</a></li><li><a href="/guide/js/scope-and-closure.html" class="sidebar-link">作用域与闭包</a></li><li><a href="/guide/js/generator.html" class="sidebar-link">迭代器与 Generator</a></li><li><a href="/guide/js/promise.html" class="sidebar-link">Promise 原理与实现</a></li><li><a href="/guide/js/async.html" class="sidebar-link">async/await 原理</a></li><li><a href="/guide/js/high-order-function.html" class="sidebar-link">JS 中的高阶函数及其应用</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="变量与类型"><a href="#变量与类型" class="header-anchor">#</a> 变量与类型</h1> <h2 id="一、js-变量在内存中的存储形式"><a href="#一、js-变量在内存中的存储形式" class="header-anchor">#</a> 一、JS 变量在内存中的存储形式</h2> <p>在 JS 中，变量分为<strong>基本类型</strong>和<strong>引用类型</strong>。基本类型是保存在栈内存中的简单数据段，它们的值都有<strong>固定的大小</strong>，保存在<strong>栈空间</strong>，通过<strong>按值访问</strong>。引用类型是保存在堆内存中的对象，<strong>值大小不固定</strong>，栈内存中存放的该对象的访问地址指向堆内存中的对象，JS 中不允许直接访问堆内存中的为位置。因此操作对象时，实际操作对象的引用。</p> <h2 id="二、js-的数据类型"><a href="#二、js-的数据类型" class="header-anchor">#</a> 二、JS 的数据类型</h2> <p>Javascript 有 8 种数据类型：</p> <ul><li><code>number</code> 类型：整数或浮点数。依据 IEEE 754 标准，使用的是 64 位双精度浮点数存储。</li> <li><code>string</code> 字符串：由一组 UTF16 编码组成，范围在 0~65536(U+0000 ~U+FFFF)之间。</li> <li><code>boolean</code> 布尔值：二元判断，只有<code>true</code>和<code>false</code></li> <li><code>null</code>: 无、未知</li> <li><code>undefined</code>: 表示未定义。不是保留字，内层作用域可以被覆写。</li> <li><code>symbol</code>: 用于唯一的标识符。</li> <li><code>object</code> 对象：一般是键值对的形式。</li> <li><code>BigInt</code>：可以表示任意大的整数。</li></ul> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p><code>function</code> 是一种数据类型吗？
根据 spec 规范，它不是。虽然 <code>typeof function() {}; // function</code>，但是<code>typeof</code>是一个运算符，其返回值不能作为 js 类型系统的依据。<code>function</code>比较特殊，它同样具有<code>object</code>的特性。</p></div> <h2 id="三、基本类型的拆箱与装箱操作"><a href="#三、基本类型的拆箱与装箱操作" class="header-anchor">#</a> 三、基本类型的拆箱与装箱操作</h2> <h3 id="装箱"><a href="#装箱" class="header-anchor">#</a> <strong>装箱</strong></h3> <p>装箱，是指将基本类型转换为对应的引用类型的操作。分为<strong>显式装箱</strong>和<strong>隐式装箱</strong>。</p> <ol><li>隐式装箱</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> s1 <span class="token operator">=</span> <span class="token string">'alin'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> s2 <span class="token operator">=</span> s1<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>上述代码的执行步骤：</p> <ul><li>创建 <code>String</code>类型的一个实例</li> <li>在实例中调用该方法</li> <li>销毁该实例</li></ul> <ol start="2"><li>显式装箱</li></ol> <p>通过<strong>基本包装类型对象</strong>对基本类型进行显示装箱。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'alin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>显式装箱可以对 <code>new</code> 出来的对象进行属性和方法的添加。</p> <p>因为通过 <code>new</code> 操作符创建的引用类型的实例，在执行流离开当前作用域之间会一直保留在内存中。</p> <h3 id="拆箱"><a href="#拆箱" class="header-anchor">#</a> <strong>拆箱</strong></h3> <p>拆箱，是指把引用类型转换为基本类型。通过引用类型的 <code>valueOf()</code> 和 <code>toString</code> 方法实现。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>在 Javascript 标准中，规定了 <code>ToPrimitive</code> 方法，它是对象类型到基本类型转换的实现者。</p></div> <p>对象到 <code>String</code> 和 <code>Number</code> 的转换遵循“先拆箱后转换”的规则。</p> <p>「拆箱转换」的调用规则及顺序如下：</p> <ol><li>检查对象是否有用户定义的 <code>[Symcol.toPrimitive]</code> 方法，如果有，直接调用。</li> <li>如果没有，执行原函数内部的 <code>ToPrimitive</code>，然后判断传入 <code>hint</code> 值，如果其值为 <code>string</code>, 顺序调用对象的 <code>toString</code> 和 <code>valueOf</code> 方法（若 <code>toString</code> 方法返回一个基本类型值，则返回，终止运算，否则继续调用 <code>valueOf</code> 方法）。</li> <li>如果传入的 <code>hint</code> 值不为 <code>string</code>，则可能为 <code>number</code> 或者 <code>default</code>，均会顺序调用对象的 <code>valueOf</code> 和 <code>toString</code> 方法（其中 <code>valueOf</code> 方法一定会执行，若返回基本类型值，则返回并终止运算，否则继续调用 <code>toString</code> 方法）。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toPrimitive<span class="token punctuation">]</span><span class="token punctuation">(</span>hint<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">hint: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>hint<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'toString'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'valueOf'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Output: hint: string</span>

b <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">;</span> <span class="token comment">// Output: hint: default</span>

b <span class="token operator">+</span> <span class="token number">500</span><span class="token punctuation">;</span> <span class="token comment">// Output: hint: default</span>

<span class="token operator">+</span>b<span class="token punctuation">;</span> <span class="token comment">// Output: hint number</span>

b <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// Output: hint number</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><code>hint</code>: 取决与上下文，转换具有所谓的“暗示”。</p> <ul><li><code>string</code>: 当一个操作期望一个字符串时</li> <li><code>number</code>: 当一操作期望一个数字时</li> <li><code>default</code>: 少数情况下，当操作者不确定期望的类型时，比如一个 <code>+</code> 运算符可用于字符串连接或者数字相加时，或者当一个对象用 <code>==</code> 与一个字符串、数字进行比较时。</li></ul> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>在实践中，为了记录和调试目的，仅实现 <code>object.toString()</code> 作为“全捕获”方法通常就够了，这样所有转换都能返回同一种“人类可读”的对象表达方式。</p></div> <h2 id="四、null-与-undefined-的区别"><a href="#四、null-与-undefined-的区别" class="header-anchor">#</a> 四、null 与 undefined 的区别</h2> <p>事实上，两者在使用中并无多大的区别。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">null</span> <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">// Output: true</span>
<span class="token keyword">null</span> <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">// Output: false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>在相等性检查中，两者是相等的。两者转换为布尔值都是 <code>false</code>。</p> <ol><li>null</li></ol> <p><code>null</code> 表示空值。在内存里表示的就是，栈中的变量没有指向堆中的内存对象。当一个对象被赋值了 <code>null</code> 以后，原来的对象在内存中就处于游离状态，GC 会择机回收该对象并释放内存。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p><code>typeof null == 'object'</code>?</p> <p><code>null</code> 有属于自己的类型 <code>Null</code>，而不属于 <code>Object</code> 类型，<code>typeof</code> 之所以会判定为 Object 类型，是因为 JavaScript 数据类型在底层都是以二进制的形式表示的，二进制的前三位为 0 会被 <code>typeof</code> 判断为对象类型，而 <code>null</code> 的二进制位恰好都是 0 ，因此，<code>null</code> 被误判断为 Object 类型。</p></div> <ol start="2"><li>undefined</li></ol> <p><code>undefined</code> 表示未定义的原始值。可以看做一个变量的原始状态。下面的这些场景，都会是 <code>undefined</code>。</p> <ul><li>变量被声明，但没有被赋值</li> <li>函数定义了形参，但没有传递实参</li> <li>函数没有返回值</li> <li>访问了对象上不存在的属性</li> <li>使用 <code>void</code> 对表达式求值</li></ul> <ol start="3"><li>区别</li></ol> <ul><li><code>null</code> 表示空值；<code>undefined</code> 表示未定义的原始值。</li> <li><code>null</code> 转换为 Number 类型时为 0；<code>undefined</code>则是 NaN。</li> <li>两者不全等。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Output: 0</span>
<span class="token function">Number</span><span class="token punctuation">(</span>undefine<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Output: NaN</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="custom-block warning"><p class="custom-block-title">注意</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">null</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
<span class="token keyword">null</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
<span class="token keyword">null</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这是因为相等性检测<code>==</code>和普通比较运算符 <code>&gt;</code> <code>&lt;</code> <code>&gt;=</code> <code>&lt;=</code> 的逻辑是相互独立的，进行值的比较时，<code>null</code> 会被转化为 0，另一方面 <code>undefined</code> 和 <code>null</code> 在相等性检测中不会进行任何的类型转换，它们有自己独立的比较规则，所以它们除了互等外，不会等于其他任何的值。</p></div> <h2 id="五、js-中判断数据类型的几种方式"><a href="#五、js-中判断数据类型的几种方式" class="header-anchor">#</a> 五、JS 中判断数据类型的几种方式</h2> <p>在 JS 中，常用的数据判断方法可以用<code>typeof</code>，<code>instanceOf</code>，<code>constructor</code>，<code>Object.protoType.toString.call()</code>这四种方法。</p> <ol><li><code>typeof</code></li></ol> <p>例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">typeof</span> <span class="token string">''</span><span class="token punctuation">;</span> <span class="token comment">// string 有效</span>
<span class="token keyword">typeof</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// number 有效</span>
<span class="token keyword">typeof</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// symbol 有效</span>
<span class="token keyword">typeof</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// boolean 有效</span>
<span class="token keyword">typeof</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">// undefined 有效</span>
<span class="token keyword">typeof</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// object 无效</span>
<span class="token keyword">typeof</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// object 无效</span>
<span class="token keyword">typeof</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// function 有效</span>
<span class="token keyword">typeof</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// object 无效</span>
<span class="token keyword">typeof</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// object 无效</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li>对于基本类型，除<code>null</code>外，都能返回正确的结果。</li> <li>对于引用类型，除<code>function</code>外，一律返回<code>object</code>类型。</li> <li>对于<code>null</code>，返回<code>object</code>类型。</li> <li>对于<code>function</code>， 返回<code>function</code>类型。</li></ul> <ol start="2"><li><code>instanceOf</code></li></ol> <p><code>instanceOf</code>原理是判断 A 是否是 B 的实例，检测的是原型。</p> <p>例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">[</span><span class="token punctuation">]</span> instanceOf Array<span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token punctuation">[</span><span class="token punctuation">]</span> indtanceOf Object<span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> instanceOf Date<span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">new</span> <span class="token class-name">Person</span> instanceOf Person<span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token punctuation">[</span><span class="token punctuation">]</span> instanceOf Object<span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> instanceOf Object<span class="token punctuation">;</span> <span class="token comment">//true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><code>instanceOf</code> 只能用判断两个对象是否是实例关系，无法判断一个对象实例具体属于哪个类型。其原理是利用原型链，如果在原型链上查找到一致的原型，就会返回真值。</p> <ol start="3"><li><code>constructor</code></li></ol> <p>当一个函数 F 被定义时，js 引擎为 F 添加了 <code>prototype</code> 原型，然后再在 <code>prototype</code> 上添加一个 <code>constructor</code> 的属性，并让其指向 F 的引用。</p> <p>例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">''</span><span class="token punctuation">.</span>constructor <span class="token operator">==</span> String<span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor <span class="token operator">==</span> Number<span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor <span class="token operator">==</span> Function<span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span>constructor <span class="token operator">==</span> Array<span class="token punctuation">;</span> <span class="token comment">// true</span>
document<span class="token punctuation">.</span>constructor <span class="token operator">==</span> HTMLDocument<span class="token punctuation">;</span> <span class="token comment">// ture</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>存在问题：</p> <ul><li><code>null</code> 和 <code>undefined</code> 是无效的对象，因此不存在 <code>constructor</code>。</li> <li>函数的 <code>construcor</code> 是不稳定的，可以重写 <code>prototype</code>，原有 <code>constructor</code> 就会丢失。</li></ul> <ol start="4"><li><code>toString</code>方法</li></ol> <p><code>toString</code> 是 <code>Object</code> 的原型方法，调用该方法，默认返回当前对象的 <code>[[class]]</code>。</p> <p>例子：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[Object String]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[Object Number]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[Object Boolean]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[Object Symbol]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[Object Undefined]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[Object Null]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[Object Function]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[Object Array]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[Object RegExp]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;[Object Error]&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>这种方式是最为通用的，能够很好的判断 js 中的数据类型。</p> <h2 id="六、隐式转换"><a href="#六、隐式转换" class="header-anchor">#</a> 六、隐式转换</h2> <p>由于 Javascript 是一门弱类型语言，因此在不同类型的变量之间相互运算时常常会发生<strong>隐式转换</strong>。Javascript 中的隐式转换常用的主要有三种： <code>ToPrimitive</code>，<code>ToNumber</code>，<code>ToString</code>。</p> <ul><li><code>ToPrimitive</code>： 将引用类型转换原始类型时候会发生调用，上面拆箱中已经介绍过了。</li> <li><code>ToNumber</code>：转换为 Number 类型， 常发生在自增、自减、数学运算符等。</li> <li><code>ToString</code>：转换为 String 类型，常发生在 + 连接字符串、引用类型比较等。</li></ul> <h3 id="tonumber"><a href="#tonumber" class="header-anchor">#</a> ToNumber</h3> <p><img src="https://allin-bucket.oss-cn-beijing.aliyuncs.com/blog/%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2-ToNumber-2019-12-17.png?x-oss-process=style/alin" alt="隐式转换-ToNumber-2019-12-17.png"></p> <h3 id="tostring"><a href="#tostring" class="header-anchor">#</a> ToString</h3> <p><img src="https://allin-bucket.oss-cn-beijing.aliyuncs.com/blog/%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2-ToString-2019-12-17.png?x-oss-process=style/alin" alt="隐式转换-ToString-2019-12-17.png"></p> <h2 id="七、精度缺失及解决办法"><a href="#七、精度缺失及解决办法" class="header-anchor">#</a> 七、精度缺失及解决办法</h2> <h3 id="双精度浮点数"><a href="#双精度浮点数" class="header-anchor">#</a> 双精度浮点数</h3> <p>精度确实并不是语言的问题，而是浮点数存储本身固有的缺陷。浮点数无法很精确表示其数值范围内的所有值，只能精确表示可用科学计数法 <code>m*2^e</code> 表示的数值而已，比如 0.5 的科学计数法是 <code>2^-1</code>，则可被精确存储了；而 0.1，0.2 则无法被精确存储。</p> <p>js 是使用 64 位双精度浮点数存储数值的，其采用的是 IEEE754 规范。</p> <p><img src="https://allin-bucket.oss-cn-beijing.aliyuncs.com/blog/ieee754-2019-12-12.png?x-oss-process=style/alin" alt="ieee754-2019-12-12.png"></p> <p>正如上图所示，64 位双精度浮点数是用 1 位符号位 S， 11 位指数 E，52 位有效数字 M 来表示的。并且一个浮点数可以使用公式表示如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>V = (-1)^S * M * 2 ^ E
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>S：符号位，0 位正数，1 位负数</li> <li>M：指有效位数，1 &lt; M &lt; 2</li> <li>E：指数位，阶数 = 指数 + 偏置量</li></ul> <h3 id="解决精度缺失的方法"><a href="#解决精度缺失的方法" class="header-anchor">#</a> 解决精度缺失的方法</h3> <ol><li>类库</li></ol> <p>如 <code>Math.js</code>等</p> <ol start="2"><li>原生方法<code>toFixed</code></li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token parameter">num<span class="token punctuation">,</span> s</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> timers <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> des <span class="token operator">=</span> num <span class="token operator">*</span> timers <span class="token operator">+</span> <span class="token number">0.5</span><span class="token punctuation">;</span>
  des <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>des<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">/</span> timers<span class="token punctuation">;</span>
  <span class="token keyword">return</span> des <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol start="3"><li>ES6</li></ol> <p>引入 <code>Number.EPSILON</code> (2.220446049250313e-16)这么小的量，在于为浮点数设置一个误差范围，如果误差小于 <code>EPSILON</code>，则认为结果是可靠的。</p> <ol start="4"><li>放大再缩小</li></ol> <p>把小数放大为整数（乘），进行算术运算，再缩小为小数（除）。</p> <h2 id="八、instanceof-实现原理"><a href="#八、instanceof-实现原理" class="header-anchor">#</a> 八、instanceOf 实现原理</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token keyword">instanceof</span><span class="token punctuation">(</span><span class="token parameter">left<span class="token punctuation">,</span> right</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获得类型的原型</span>
  <span class="token keyword">let</span> prototype <span class="token operator">=</span> right<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
  <span class="token comment">// 获得对象的原型</span>
  left <span class="token operator">=</span> left<span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span>
  <span class="token comment">// 判断对象的类型是否等于类型的原型</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>prototype <span class="token operator">===</span> left<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    left <span class="token operator">=</span> left<span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">修订于:</span> <span class="time">2020-04-04 18:37:29</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/css/center-and-layout.html" class="prev">水平居中方案与常见布局</a></span> <span class="next"><a href="/guide/js/prototype.html">原型与继承</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.0d36fc07.js" defer></script><script src="/assets/js/2.b6aa8f81.js" defer></script><script src="/assets/js/46.dcbd0d34.js" defer></script>
  </body>
</html>
